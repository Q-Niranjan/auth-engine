# ─────────────────────────────────────────────
# Application
# ─────────────────────────────────────────────
APP_NAME=AuthEngine
APP_VERSION=1.0.0
DEBUG=False
API_V1_PREFIX=/api/v1
APP_URL=http://localhost:8000

# ─────────────────────────────────────────────
# Security  (generate: openssl rand -hex 32)
# ─────────────────────────────────────────────
SECRET_KEY=change-this-to-a-random-32-char-secret-key
ALGORITHM=HS256

JWT_SECRET_KEY=change-this-to-a-random-32-char-jwt-secret
JWT_ALGORITHM=HS256
JWT_ISSUER=authengine
JWT_AUDIENCE=authengine-api

# ─────────────────────────────────────────────
# Tokens
# ─────────────────────────────────────────────
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
MAGIC_LINK_TTL_SECONDS=900

# ─────────────────────────────────────────────
# Databases
# ─────────────────────────────────────────────
POSTGRES_URL=postgresql+asyncpg://<authengine>:<password>@localhost:5432/authengine 
POSTGRES_POOL_SIZE=20   
POSTGRES_MAX_OVERFLOW=10

MONGODB_URL=mongodb://<admin>:<strongpassword>@localhost:27017/authengine?authSource=admin
MONGODB_DB_NAME=authengine

REDIS_URL=redis://:admin123@localhost:6379/0
REDIS_DB=0
REDIS_MAX_CONNECTIONS=50

# ─────────────────────────────────────────────
# Super Admin  (auto-created on first startup)
# ─────────────────────────────────────────────
SUPERADMIN_EMAIL=admin@example.com
SUPERADMIN_PASSWORD=Admin@1234!

# ─────────────────────────────────────────────
# Password Policy
# ─────────────────────────────────────────────
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=True
PASSWORD_REQUIRE_LOWERCASE=True
PASSWORD_REQUIRE_DIGIT=True
PASSWORD_REQUIRE_SPECIAL=True

# ─────────────────────────────────────────────
# Sessions & Rate Limiting
# ─────────────────────────────────────────────
MAX_CONCURRENT_SESSIONS=5
SESSION_TIMEOUT_MINUTES=60
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=10

# ─────────────────────────────────────────────
# Email  (SendGrid shown — swap provider as needed)
# ─────────────────────────────────────────────
EMAIL_PROVIDER=sendgrid
EMAIL_PROVIDER_API_KEY=SG.your-sendgrid-api-key-here
EMAIL_SENDER=noreply@yourdomain.com

# ─────────────────────────────────────────────
# SMS  (Twilio shown — leave blank to disable)
# ─────────────────────────────────────────────
SMS_PROVIDER=twilio
SMS_PROVIDER_API_KEY=your-twilio-auth-token
SMS_PROVIDER_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx # pragma: allowlist secret
SMS_SENDER=+1234567890

# ─────────────────────────────────────────────
# OAuth  (leave CLIENT_ID blank to disable that provider)
# ─────────────────────────────────────────────
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/auth/oauth/google/callback

GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_REDIRECT_URI=http://localhost:8000/api/v1/auth/oauth/github/callback

MICROSOFT_CLIENT_ID=your-microsoft-client-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
MICROSOFT_REDIRECT_URI=http://localhost:8000/api/v1/auth/oauth/microsoft/callback
